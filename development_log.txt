ユーザの作成
開発用、テスト用、実装用それぞれ
mysql> grant select,insert,update,delete,alter,create,drop,index,lock tables,trigger
 on dapi_development.* to 'dapi'@'localhost' identified by 'dapi';
mysql> grant select,insert,update,delete,alter,create,drop,index,lock tables,trigger
 on dapi_test.* to 'dapi'@'localhost' identified by 'dapi';
mysql> grant select,insert,update,delete,alter,create,drop,index,lock tables,trigger
 on dapi_production.* to 'dapi'@'localhost' identified by 'dapi';

 dapi のプロジェクト作成
$rails _2.3.8_ -d mysql dapi
 
 database.yml でユーザの指定とパスワードの指定
 
rake db:create でデータベースを作成

各テーブルのモデルを作成 
$ruby script\generate model Enq
 enq_id:integer title:string description:string css:string movie:string update_name:string update_date:date 
 
$ruby script\generate model EnqPage
enq_id:integer page_id:integer face:string description:string update_name:string update_date:date 
 
$ruby script\generate model EnqQuestion
 enq_id:integer no:integer question_id:integer update_name:string update_date:date

$ruby script\generate model Question
 question_id:integer kind:string title:string content:string answer_content:string
 answer_description:string update_name:string update_date:date
 
$ruby script\generate model Choice
 question_id:integer choice_id:integer content:string update_name:string update_date:date

$ruby script\generate model Answer
 enq_id:integer no:string answer:string update_name:string update_date:date question_id:integer
 choice_id:integer content:string update_name:string update_date:date
 
各々のマイグレーションファイルを、DB設計書のとおりに記述し直す。
enq
	null => false の追加、　enq_id のindex化とユニーク制約
enq_pages
	null => false の追加、　enq_id,page_id,face のindex化とユニーク制約
enq_questions
	null => false の追加、　enq_id,no のindex化とユニーク制約、　question_id のindex化
questions
	null => false の追加、　question_id のindex化とユニーク制約
choice
	null => false の追加、　question_id,choice_id のindex化とユニーク制約
answers
	null => false の追加、　enq_id,page_id,no のindex化とユニーク制約
 

$rake db:migrate 
 
各リレーションを設定

enq
	has_many :enq_pages
enq_pages
	belongs_to :enq
	has_many :enq_questions
enq_questions
	belongs_to :enq_page
	belongs_to :question
	has_many :answers
questions
	has_many :enq_questions
	has_many :choices
choice
	belongs_to :question
answers
	belongs_to :enq_questions
 
 
json のインストール
(windowsの場合、devkitvars にパスを入れるのを忘れない)
$gem install json
json-1.7.3 を取得。バージョンが高すぎる可能性があるので、必要に応じて下げる
参考：http://www.nilab.info/z3/20110124_z01.html
では、1.8.7環境で、json-1.5.0 もしくは
参考：http://d.hatena.ne.jp/MonteCut/20110219
のように、json-1.4.6
そして、一応jsonエラーの参考
参考：http://d.hatena.ne.jp/otn/20110302/p1


コントローラの作成
アンケート情報取得
$ruby script/generate controller Enq get index show
アンケート情報取得
$ruby script/generate controller EnqPage get index show
回答データの送信
$ruby script/generate controller Answer send index show
トップページ
$ruby script/generate controller Top index

 
 
 
 
 